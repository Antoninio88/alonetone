<div class="track-content" data-controller="big-play <%= "single-playback" unless @playlist %> " data-big-play-waveform="<%= @asset.audio_feature&.waveform&.join(', ') %>"> 
  <div class="player">
    <div class="play-button-container" data-target="big-play.play" data-action="click->big-play#togglePlay">
      <div class='play-button play-control'>
        <%= link_to media_url(@asset), data: { target: 'single-playback.play' } do %>
				<svg data-target="big-play.playButton" class="largePlaySVG" viewBox="0 0 800 600" xmlns="http://www.w3.org/2000/svg">
				 <defs>
				  <clipPath id="dottyMask">
				      <path class="dottyMask" d="M300,545C164.69,545,55,435.31,55,300S164.69,55,300,55,545,164.69,545,300,435.31,545,300,545Z" fill="red" stroke="#000" stroke-miterlimit="10" stroke-width="0"/>   
				  </clipPath>
				 </defs>
				      <circle class="outline" cx="300" cy="300" r="245" fill="none" stroke="#000" stroke-miterlimit="10" stroke-width="15.68"/>

				      <g clip-path="url(#dottyMask)">
				        <circle class="dotty" cx="300" cy="300" r="245" fill="none" stroke="#000" stroke-miterlimit="10" stroke-linecap="butt" stroke-width="64" stroke-dasharray="68.99 187.58"/>
				      </g>
				      <path class="icon" d="M205.26,457.84,205,142.18a.64.64,0,0,1,1-.56L331.53,214l147.93,85.25a.63.63,0,0,1,0,1.1L206.21,458.39A.63.63,0,0,1,205.26,457.84Z"/>
				      <circle class="centerCircle" cx="300" cy="300" r="123"/>
				 <g class="pauseContainer">
				      <g class="pauseLoopGroup" fill="none" stroke="#fff" stroke-miterlimit="10" stroke-width="64">
				        <line x1="245" y1="146" x2="245" y2="450" />
				        <line x1="355" y1="146" x2="355" y2="450" />
				      </g>
				 </g>
				     <g class="pauseGroup" fill="none" stroke="#fff" stroke-miterlimit="10" stroke-width="64">
				        <line x1="245" y1="156" x2="245" y2="430" />
				        <line x1="355" y1="156" x2="355" y2="430" />
				      </g> 
				</svg>
        <% end %>
      </div>
    </div>

    <div class="waveform" data-target='big-play.waveform' data-action='mousemove->big-play#skim click->big-play#seek'>
      <div class="seekbar" data-target="big-play.seekBar"></div>
    </div>

    <div class="time">
      <span class="index" data-target="big-play.time">0:00</span> of <%= @asset.length %>
    </div>

    <div class="download-button">
      <%= link_to '', media_url(@asset) %>
    </div>
  </div>

  <div class="edit-links">
    <% if authorized? %>
      <%= link_to("Edit", edit_user_track_path(@user, @asset), class: "edit-link") %>
    <% end %>
    <% if moderator? %>
      <% if @asset.private? %> 
        <%= link_to "Unspam", unspam_user_track_path(@user, @asset), method: :put, class: "edit-link" %>
      <% else %>
        <%= link_to "Spam", spam_user_track_path(@user, @asset), method: :put, class: "edit-link" %>
      <% end %>
    <% end %>
  </div>

  <% if logged_in? %>
  <div class="track-favorite">
  <%= link_to toggle_favorite_path(asset_id: @asset.id), remote: true, class: 'add_to_favorites', 
      data: {controller: 'favorite', action: 'favorite#toggle' } do %>
      <svg id="faveSVG" class="faveSVG" viewBox="0 0 600 600" xmlns="http://www.w3.org/2000/svg">
        <path class="outline" d="M299.64,180.06C254.2,95.52,123.26,90.77,87.58,197,42.14,332.24,189.85,374.17,299.64,484.42,409.43,374.17,557.14,332.24,511.7,197,476,90.77,345.08,95.52,299.64,180.06Z" fill="none" stroke="#b4b4b4" stroke-miterlimit="10" stroke-width="35" />
        <circle class="purplePop" cx="490" cy="410" r="123" fill="none" stroke="#CC3CF6" stroke-miterlimit="10" stroke-linecap="square" stroke-width="0" />
        <circle class="greenPop" cx="206" cy="483" r="123" fill="none" stroke="#3BF686" stroke-miterlimit="10" stroke-linecap="square" stroke-width="0" />
        <circle class="bluePop" cx="340" cy="90" r="123" fill="none" stroke="#3D45F6" stroke-miterlimit="10" stroke-linecap="square" stroke-width="0" />
        <circle class="yellowPop" cx="112" cy="336" r="123" fill="none" stroke="#F6CD3F" stroke-miterlimit="10" stroke-linecap="square" stroke-width="0" />
        <circle class="redPop" cx="128" cy="124" r="123" fill="none" stroke="#F6463E" stroke-miterlimit="10" stroke-linecap="square" stroke-width="0" />
        <circle class="redPop2" cx="485" cy="130" r="123" fill="none" stroke="#F6463E" stroke-miterlimit="10" stroke-linecap="square" stroke-width="0" />
        <circle class="redPop3" cx="480" cy="436" r="123" fill="none" stroke="#F6463E" stroke-miterlimit="10" stroke-linecap="square" stroke-width="0" />
        <path class="heart" d="M299.64,180.06C254.2,95.52,123.26,90.77,87.58,197,42.14,332.24,189.85,374.17,299.64,484.42,409.43,374.17,557.14,332.24,511.7,197,476,90.77,345.08,95.52,299.64,180.06Z" fill="#f6463e" stroke="#f6463e" stroke-miterlimit="10" stroke-width="21" />
    </svg>
  <% end %>
  </div>
  <% end %>

  <div class="track-post">
    <h1><%= @asset.name %></h1>
    <% unless @playlist %>
      <h3><%= link_to @asset.user.display_name, user_home_path(@asset.user) %></h3>
    <% end %>
    <%= markdown(@asset.description) %>
    <p class="track-stats">
      Uploaded <strong><%= local_time_ago(@asset.created_at) %></strong>. Listened to <strong><%= @asset.listens_count %></strong> times.
    </p>
    <p>
      <%= markdown(@asset.credits) if @asset.credits.present? %>
    </p>
  </div>

  <%= render partial: 'assets/comment_white', locals: { asset: @asset }%>

</div>
