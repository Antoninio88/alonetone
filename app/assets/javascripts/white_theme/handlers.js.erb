document.addEventListener("turbolinks:load", function() {

    // svg default playlists
    $('#playlist-and-track-content .no_pic').each(function(){
      $(this).append(makeSVGFromTitle(800, $('h1:first').text().trim()))
    })
    $('li a .no_pic').each(function(){
      $(this).append(makeSVGFromTitle(800, $(this).parent().attr('title').trim()))
    })

    $("a.add_to_favorites").load("<%= asset_path('default/fave-animation.svg') %>");

    $("div.asset").click( function() {
        var myFaveAnim = new FaveAnim($(this).find("a.add_to_favorites"));
        myFaveAnim.init();
        if ( $(this).find("a.add_to_favorites").hasClass("favorited") ) {
            myFaveAnim.setFave();
        }
        $(this).find("a.add_to_favorites").click( function() {
            if ( $(this).hasClass("favorited") ) {
                myFaveAnim.clickFave();
            } else {
                myFaveAnim.clickUnfave();
            }
        });
    });

    $("a.follow").empty();
    $("a.follow").append( $("<div class='follow_animation'></div>") );
    $("a.follow").addClass("white_theme");

    $("a.follow .follow_animation").load("<%= asset_path('default/fave-animation.svg') %>", function(){
        var myFaveAnim = new FaveAnim($("a.follow"));
        myFaveAnim.init();

        if ( $(this).parent().hasClass("following") ) {
            myFaveAnim.setFave();
        }

        $("a.follow").click( function() {
            if ( $(this).hasClass("following") ) {
                myFaveAnim.clickFave();
            } else {
                myFaveAnim.clickUnfave();
            }
        });
    });

    $("body").append( $("<div id='play-svg-container' style='display:none'></div)") );
    $("#play-svg-container").load("<%= asset_path('default/play-animation.svg') %>");
    $(".sprites-play > a").load("<%= asset_path('default/play-icon.svg') %>");

    var myPlayAnimation = new PlayAnimation();

    $("div.play-button a").click(function() {
        var playAnimationSVG = $("#playAnimationSVG");
        $(".playIconSymbol").show();
        $(this).find("#playIconSymbol").hide();
        $(this).append(playAnimationSVG);
        myPlayAnimation.init()
        myPlayAnimation.setPlay()
        myPlayAnimation.showLoading();
        TweenMax.delayedCall(1, function() { myPlayAnimation.showPause(); })
    })

    if ( $(".track-content").length == 1 ) {
        var playAnimationSVG = $("#playAnimationSVG");
        $("div.player .play-button-container").prepend($("<div class='play-button play-control'></div>"))
        $("div.player .play-button-container > div:first-child").load("<%= asset_path('default/play-icon.svg') %>");
        $("div.player .play-button-container > div:first-child").click(function() {
            var playAnimationSVG = $("#playAnimationSVG");
            $(".playIconSymbol").show();
            $(this).find("#playIconSymbol").hide();
            $(this).append(playAnimationSVG);
            myPlayAnimation.init()
            myPlayAnimation.setPlay()
            myPlayAnimation.showLoading();
            TweenMax.delayedCall(1, function() { myPlayAnimation.showPause(); })
        })
    }
});
